"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{80182:function(e,t,i){i.d(t,{e:function(){return CapacitorView}});var o=i(74806),n=i(24206);let CapacitorView=class CapacitorView{async dispose(){this.keyboardView.dispose(),await this.keyboardToolbarView.dispose()}constructor(){this.keyboardView=new n.q,this.keyboardToolbarView=new o.q}}},94541:function(e,t,i){i.d(t,{F0:function(){return CapacitorViewProvider},l3:function(){return useCapacitorView},ze:function(){return useKeyboardView},zz:function(){return useKeyboardToolbarView}});var o=i(85893),n=i(67294),a=i(77004),r=i(80182);let s=(0,n.createContext)(void 0),CapacitorViewProvider=e=>{let{children:t}=e,i=(0,a.D)(()=>new r.e,[]);return(0,o.jsx)(s.Provider,{value:i,children:t})};function useCapacitorView(){let e=(0,n.useContext)(s);if(!e)throw Error("useCapacitorView must be used within a CapacitorViewProvider");return e}function useKeyboardView(){let{keyboardView:e}=useCapacitorView();return e}function useKeyboardToolbarView(){let{keyboardToolbarView:e}=useCapacitorView();return e}},23164:function(e,t,i){i.d(t,{ze:function(){return o.ze},zz:function(){return o.zz}}),i(80182);var o=i(94541);i(74806),i(24206)},74806:function(e,t,i){i.d(t,{q:function(){return KeyboardToolbarView}});var o=i(97582),n=i(96826),a=i(64406),r=i(18446),s=i.n(r),l=i(10928),d=i.n(l),c=i(68949),u=i(29895);let KeyboardToolbarWeb=class KeyboardToolbarWeb extends u.Uw{setItems(){}show(){}hide(){}getHasExternalKeyboard(){return Promise.resolve({isConnected:!1})}};let b=(0,u.fo)("KeyboardToolbar",{web:new KeyboardToolbarWeb});let KeyboardToolbarView=class KeyboardToolbarView{async dispose(){for(let e of this.listeners)(await Promise.resolve(e))()}observeEditor(){this.listeners.push((0,c.reaction)(()=>{let{canIndent:e,canDedent:t,canMoveUp:i,canMoveDown:o}=this;return{canIndent:e,canDedent:t,canMoveUp:i,canMoveDown:o}},e=>this.updateToolbar(e),{fireImmediately:!0,equals:s()}))}async observePlugin(){let e=await b.getHasExternalKeyboard();this.setHasExternalKeyboard(e.isConnected),this.listeners.push((await b.addListener("action",e=>{this.handleCommand(e)})).remove),this.listeners.push((await b.addListener("visibility",e=>{this.setIsVisible(e.isVisible)})).remove),this.listeners.push((await b.addListener("externalKeyboard",e=>{this.setHasExternalKeyboard(e.isConnected)})).remove)}setSelectionOptions(e){this.canIndent=e.canIndent,this.canDedent=e.canDedent,this.canMoveUp=e.canMoveUp,this.canMoveDown=e.canMoveDown,this.selectedSubject=e.selectedSubject}setIsVisible(e){this.isVisible=e}setHasExternalKeyboard(e){this.hasExternalKeyboard=e}show(e){this.editorRef=e,b.show()}hide(){b.hide()}updateToolbar(e){b.setItems({items:function(e){let{canIndent:t,canDedent:i,canMoveUp:o,canMoveDown:n}=e;return[{type:"action",icon:"slash",action:"insertCommand"},{type:"action",icon:"bullet-list",action:"insertBullet"},{type:"action",icon:"todo-list",action:"insertTask"},{type:"action",icon:"backlink",action:"insertBacklink"},{type:"action",icon:"hashtag",action:"insertTag"},{type:"action",icon:"outdent",action:"outdent",disabled:!i},{type:"action",icon:"indent",action:"indent",disabled:!t},{type:"action",icon:"move-up",action:"moveUp",disabled:!o,canHide:!0},{type:"action",icon:"move-down",action:"moveDown",disabled:!n,canHide:!0},{type:"action",icon:"image",action:"insertImage"}]}(e)})}handleCommand(e){var t;let{action:i}=e,o=null===(t=this.editorRef)||void 0===t?void 0:t.current;switch(i){case"insertCommand":null==o||o.insertText("/");break;case"insertBullet":null==o||o.turnToBulletList();break;case"insertTask":null==o||o.turnToTaskList();break;case"insertBacklink":null==o||o.insertText("[[");break;case"insertTag":null==o||o.insertText("#");break;case"indent":null==o||o.indentListItem();break;case"outdent":null==o||o.dedentListItem();break;case"moveUp":null==o||o.moveUpListItem();break;case"moveDown":null==o||o.moveDownListItem();break;case"insertImage":this.insertImage();break;case"dismiss":null==o||o.blur()}}async insertImage(){let e=this.editorRef.current,t=[];try{t=(await n.V1.pickImages({width:1e3,quality:80,presentationStyle:"popover"})).photos}catch(e){console.warn(e)}for(let i of t){let{path:t}=i;if(!t)continue;let o=await a.fy.readFile({path:t}),n=d()(t.split("/")),r=await fetch("data:text/plain;base64,"+o.data),s=await r.arrayBuffer(),l=new File([s],n);null==e||e.uploadImages([l])}}constructor(){this.canIndent=!1,this.canDedent=!1,this.canMoveUp=!1,this.canMoveDown=!1,this.selectedSubject=!1,this.isVisible=!1,this.hasExternalKeyboard=!1,this.editorRef={current:null},this.listeners=[],(0,c.makeObservable)(this),this.observeEditor(),this.observePlugin()}};(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"canIndent",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"canDedent",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"canMoveUp",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"canMoveDown",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"selectedSubject",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"isVisible",void 0),(0,o.gn)([c.observable],KeyboardToolbarView.prototype,"hasExternalKeyboard",void 0),(0,o.gn)([c.action],KeyboardToolbarView.prototype,"setSelectionOptions",null),(0,o.gn)([c.action],KeyboardToolbarView.prototype,"setIsVisible",null),(0,o.gn)([c.action],KeyboardToolbarView.prototype,"setHasExternalKeyboard",null)},24206:function(e,t,i){i.d(t,{q:function(){return KeyboardView}});var o=i(97582),n=i(29895),a=i(50842),r=i(68949);let KeyboardView=class KeyboardView{dispose(){this.listeners.forEach(e=>e.remove())}hasKeyboardPlugin(){return n.dV.isPluginAvailable("Keyboard")}setHeight(e){this.keyboardHeight={type:"exact",value:e}}setStatus(e){this.status=e}get wantsSpacer(){return"showing"===this.status||"visible"===this.status}get isHidden(){return"hidden"===this.status||"hiding"===this.status}async observeKeyboard(){this.hasKeyboardPlugin()&&this.listeners.push(await a.N1.addListener("keyboardWillShow",e=>{this.setHeight(e.keyboardHeight),this.setStatus("showing")}),await a.N1.addListener("keyboardDidShow",e=>{this.setHeight(e.keyboardHeight),this.setStatus("visible")}),await a.N1.addListener("keyboardWillHide",()=>{this.setStatus("hiding")}),await a.N1.addListener("keyboardDidHide",()=>{this.setStatus("hidden")}))}constructor(){this.listeners=[],this.keyboardHeight={type:"approx",value:380},this.status="hidden",(0,r.makeObservable)(this),this.observeKeyboard()}};(0,o.gn)([r.observable],KeyboardView.prototype,"keyboardHeight",void 0),(0,o.gn)([r.observable],KeyboardView.prototype,"status",void 0),(0,o.gn)([r.action],KeyboardView.prototype,"setHeight",null),(0,o.gn)([r.action],KeyboardView.prototype,"setStatus",null),(0,o.gn)([r.computed],KeyboardView.prototype,"wantsSpacer",null),(0,o.gn)([r.computed],KeyboardView.prototype,"isHidden",null)},26988:function(e,t,i){i.d(t,{L:function(){return useCapacitorContainer},X:function(){return CapacitorContainer}});var o=i(85893),n=i(90512),a=i(46670),r=i(67294),s=i(23164),l=i(88766);let d=(0,r.createContext)(void 0);function useCapacitorContainer(){return(0,r.useContext)(d)}let CapacitorContainer=e=>(0,l.W)()?(0,o.jsx)(c,{...e}):(0,o.jsx)(CapacitorContainerWeb,{...e}),c=(0,a.Pi)(e=>{let{children:t,className:i,...a}=e,l=(0,s.ze)(),c=(0,r.useRef)(null);return(0,o.jsx)(d.Provider,{value:c,children:(0,o.jsxs)("div",{...a,className:(0,n.Z)("h-full overflow-y-auto",i),ref:c,children:[t,l.wantsSpacer&&(0,o.jsx)("div",{style:{height:"".concat(l.keyboardHeight.value,"px")}})]})})}),CapacitorContainerWeb=e=>{let{children:t,className:i,...a}=e;return(0,o.jsx)("div",{...a,className:(0,n.Z)("h-full overflow-y-auto",i),children:t})}},70670:function(e,t,i){i.d(t,{S:function(){return CapacitorScreen}});var o=i(85893),n=i(90512),a=i(23164),r=i(88766),s=i(77004),l=i(97582),d=i(68949);let CapacitorScreenView=class CapacitorScreenView{setDiv(e){this.divRef=e}observeBodyStyle(){let e=window.document.body,t=new MutationObserver(()=>{this.setBodyHeight(e.style.height||null)});t.observe(e,{attributes:!0,attributeFilter:["style"]}),this.listeners.push(()=>t.disconnect())}setBodyHeight(e){this.bodyHeight=e}dispose(){for(let e of this.listeners)e()}constructor({keyboardToolbarView:e}){this.divRef=null,this.bodyHeight=null,this.listeners=[],this.keyboardToolbarView=e,(0,d.makeObservable)(this),this.observeBodyStyle(),this.listeners.push((0,d.reaction)(()=>({bodyHeight:this.bodyHeight,hasExternalKeyboard:this.keyboardToolbarView.hasExternalKeyboard}),e=>{var t;let{bodyHeight:i,hasExternalKeyboard:o}=e,n=o?null:i;null===(t=this.divRef)||void 0===t||t.style.setProperty("height",n||"100vh")},{fireImmediately:!0}))}};function CapacitorScreen(e){return(0,r.W)()?(0,o.jsx)(CapacitorScreenNative,{...e}):(0,o.jsx)(CapacitorScreenWeb,{...e})}function CapacitorScreenNative(e){let{as:t,children:i,style:r,className:l,...d}=e,c=t||"div",u=(0,a.zz)(),b=(0,s.D)(()=>new CapacitorScreenView({keyboardToolbarView:u}),[u]);return(0,o.jsx)(c,{...d,className:(0,n.Z)("fixed top-0 right-0 left-0",l),style:{...r,height:"100vh"},ref:e=>b.setDiv(e),children:i})}function CapacitorScreenWeb(e){let{as:t,children:i,className:a,...r}=e,s=t||"div";return(0,o.jsx)(s,{...r,className:(0,n.Z)("fixed inset-0",a),children:i})}(0,l.gn)([d.observable],CapacitorScreenView.prototype,"keyboardToolbarView",void 0),(0,l.gn)([d.observable],CapacitorScreenView.prototype,"divRef",void 0),(0,l.gn)([d.observable],CapacitorScreenView.prototype,"bodyHeight",void 0),(0,l.gn)([d.action],CapacitorScreenView.prototype,"setDiv",null),(0,l.gn)([d.action],CapacitorScreenView.prototype,"setBodyHeight",null)},78789:function(e,t,i){i.d(t,{r:function(){return FullModalDark}});var o=i(85893),n=i(96445),a=i(90512);i(67294);var r=i(33674);let FullModalDark=e=>{let{open:t=!0,onClose:i,children:s}=e;return(0,o.jsx)(r.y,{in:t,children:(0,o.jsxs)("div",{className:"fixed inset-0 z-50 flex select-none items-center justify-center overflow-y-auto bg-gradient-to-b from-bluegray-900 to-near-black px-4 pt-4 pb-20",role:"modal",children:[i&&(0,o.jsx)("nav",{className:"absolute right-0 top-0 px-4 py-4",children:(0,o.jsxs)("button",{role:"button","aria-label":"Close",onClick:i,className:"flex cursor-pointer items-center space-x-2 text-sm text-near-white outline-none transition hover:text-gray-900",children:[(0,o.jsx)("span",{children:"Close"}),(0,o.jsx)("span",{className:"rounded-md bg-dark-black-800 px-1.5 py-0.5 text-xs",children:"Esc"}),(0,o.jsx)(n.Z,{height:15,width:15})]})}),(0,o.jsx)("div",{className:(0,a.Z)(["inline-block align-bottom","relative px-4 py-4","transform transition-all","text-gray-900"]),role:"dialog",children:s})]})})}},33674:function(e,t,i){i.d(t,{y:function(){return FadeInTransition}});var o=i(85893);i(67294);var n=i(16592);let FadeInTransition=e=>{let{in:t,children:i,duration:a=120}=e,r={transition:"opacity ".concat(a,"ms"),opacity:0},s={entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0},unmounted:{}};return(0,o.jsx)(n.ZP,{timeout:a,in:t,mountOnEnter:!0,unmountOnExit:!0,children:e=>(0,o.jsx)("div",{style:{...r,...s[e]},children:i})})}},77004:function(e,t,i){i.d(t,{D:function(){return useViewModel}});var o=i(67294);function useViewModel(e,t){let i=(0,o.useRef)(null),n=(0,o.useMemo)(()=>{var t;null===(t=i.current)||void 0===t||t.dispose();let o=e();return i.current=o,o},t);return(0,o.useEffect)(()=>()=>{var e;null===(e=i.current)||void 0===e||e.dispose(),i.current=null},[]),n}}}]);